<!doctype html>

<script>
    // example usage
    document.write(`<pre>${ cloudflow_check_webgl() ? 'Interactive' : 'Fallback'}</pre>`);

    function cloudflow_check_webgl() {
        try {
            var c = document.createElement('canvas');
            var gl = c.getContext('webgl') || c.getContext('experimental-webgl');
            if (!gl)
                return false;

            var supported_extensions = gl.getSupportedExtensions();
            function check_extensions() {
                for (var i = 0; i < arguments.length; ++i)
                    if (supported_extensions.indexOf(arguments[i]) < 0)
                        return false;
                return true;
            }

            // required extensions
            var ok = check_extensions(
                'OES_element_index_uint',
                'ANGLE_instanced_arrays',
                'OES_texture_float', 'OES_texture_float_linear',
                'OES_standard_derivatives');
            
            // compressed texture formats
            ok = ok && (
                check_extensions('WEBGL_compressed_texture_s3tc') ||
                check_extensions('WEBKIT_WEBGL_compressed_texture_pvrtc'));

            return ok;
        } catch (e) {
            return false;
        }
    }
</script>

<style>
    @import url(https://fonts.googleapis.com/css?family=Cousine);
    pre {
        position: absolute;
        left: 50%; top: 50%; margin: 0;
        transform: translate(-50%, -50%);
        font: 30px Cousine;
    }
</style>
